#!/bin/bash

# Lock the screen
if command -v hyprlock >/dev/null 2>&1; then
  pidof hyprlock >/dev/null 2>&1 || setsid uwsm-app -- hyprlock &
elif command -v loginctl >/dev/null 2>&1; then
  loginctl lock-session
else
  notify-send "Lock" "No screen lock utility available (hyprlock/loginctl)."
fi

# Set keyboard layout to default (first layout)
hyprctl switchxkblayout all 0 > /dev/null 2>&1

# Ensure 1password is locked
if pgrep -x "1password" >/dev/null; then
  1password --lock &
fi

# Avoid running screensaver when locked
pkill -f org.omarchy.screensaver
