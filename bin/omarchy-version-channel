#!/bin/bash

STATE_FILE="$HOME/.local/state/omarchy/channel"

if [[ -f "$STATE_FILE" ]]; then
  cat "$STATE_FILE"
  exit 0
fi

if [[ -n "${OMARCHY_PATH:-}" ]]; then
  branch=$(git -C "$OMARCHY_PATH" rev-parse --abbrev-ref HEAD 2>/dev/null || true)
else
  branch=$(git rev-parse --abbrev-ref HEAD 2>/dev/null || true)
fi

if [[ "$branch" == "dev" ]]; then
  echo "dev"
elif [[ -n "$branch" ]]; then
  echo "stable"
else
  echo "unknown"
fi
